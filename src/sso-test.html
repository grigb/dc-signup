<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DC SSO Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .test-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #333;
        }
        
        .demo-container {
            background: white;
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .code-block {
            background: #2d3748;
            color: #f7fafc;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .test-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: opacity 0.2s;
        }
        
        .test-btn:hover {
            opacity: 0.9;
        }
        
        .test-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .test-btn.secondary {
            background: #6c757d;
            color: white;
        }
        
        .test-btn.success {
            background: #28a745;
            color: white;
        }
        
        .test-btn.danger {
            background: #dc3545;
            color: white;
        }
        
        .member-content {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .user-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>DC Single Sign-On (SSO) Test Page</h1>
    <p>This page demonstrates the DC SSO system that can be embedded on any Distributed Creatives site.</p>
    
    <div class="test-section">
        <h2>1. Basic SSO Widget</h2>
        <p>Default widget with all options enabled:</p>
        
        <div class="demo-container">
            <div id="sso-widget-basic" 
                 data-dc-sso
                 data-show-avatar="true"
                 data-show-name="true"
                 data-show-creator-badge="true"
                 data-compact="false">
                Loading...
            </div>
        </div>
        
        <div class="code-block">
&lt;div id="sso-widget-basic" 
     data-dc-sso
     data-show-avatar="true"
     data-show-name="true"
     data-show-creator-badge="true"
     data-compact="false"&gt;
&lt;/div&gt;

&lt;script src="https://signup.distributedcreatives.org/dc-sso-widget.js"&gt;&lt;/script&gt;
        </div>
    </div>
    
    <div class="test-section">
        <h2>2. Compact Widget</h2>
        <p>Compact version for headers/sidebars:</p>
        
        <div class="demo-container">
            <div id="sso-widget-compact" 
                 data-dc-sso
                 data-show-avatar="true"
                 data-show-name="true"
                 data-show-creator-badge="true"
                 data-compact="true">
                Loading...
            </div>
        </div>
        
        <div class="code-block">
&lt;div id="sso-widget-compact" 
     data-dc-sso
     data-compact="true"&gt;
&lt;/div&gt;
        </div>
    </div>
    
    <div class="test-section">
        <h2>3. JavaScript Initialization</h2>
        <p>Widget initialized with JavaScript and custom callbacks:</p>
        
        <div class="demo-container">
            <div id="sso-widget-js">
                Loading...
            </div>
        </div>
        
        <div class="code-block">
&lt;div id="sso-widget-js"&gt;&lt;/div&gt;

&lt;script src="https://signup.distributedcreatives.org/dc-sso-widget.js"&gt;&lt;/script&gt;
&lt;script&gt;
initDCSSO('sso-widget-js', {
    showAvatar: true,
    showName: true,
    showCreatorBadge: true,
    compact: false,
    theme: 'default',
    onLogin: function(user) {
        console.log('User logged in:', user);
        showMemberContent();
    },
    onLogout: function() {
        console.log('User logged out');
        hideMemberContent();
    }
});
&lt;/script&gt;
        </div>
    </div>
    
    <div class="test-section">
        <h2>4. Member-Only Content</h2>
        <p>Content that shows/hides based on login status:</p>
        
        <div id="member-content" class="member-content" style="display: none;">
            <h3>ðŸŽ‰ Welcome, Member!</h3>
            <p>This content is only visible to logged-in members.</p>
            <ul>
                <li>Access to member forums</li>
                <li>Creator collaboration tools</li>
                <li>Exclusive resources</li>
                <li>Community events</li>
            </ul>
        </div>
        
        <div id="public-content" class="status info">
            <strong>Public Content:</strong> This is visible to everyone. Log in to see member-only features!
        </div>
    </div>
    
    <div class="test-section">
        <h2>5. User Information Display</h2>
        <p>Current user session data:</p>
        
        <div id="user-info" class="user-info">
            <strong>Status:</strong> <span id="auth-status">Checking...</span><br>
            <div id="user-details" style="display: none;">
                <strong>Name:</strong> <span id="user-name"></span><br>
                <strong>Email:</strong> <span id="user-email"></span><br>
                <strong>Creator Types:</strong> <span id="user-creator-types"></span><br>
                <strong>Member Since:</strong> <span id="user-created"></span><br>
                <strong>Verified:</strong> <span id="user-verified"></span><br>
                <strong>Status:</strong> <span id="user-status"></span>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>6. Test Controls</h2>
        <p>Debug and testing functions:</p>
        
        <div class="test-controls">
            <button class="test-btn primary" onclick="testSessionCheck()">Check Session</button>
            <button class="test-btn secondary" onclick="testRefresh()">Refresh Widgets</button>
            <button class="test-btn success" onclick="testLocalStorage()">Show Local Storage</button>
            <button class="test-btn danger" onclick="testClearSession()">Clear Session</button>
        </div>
        
        <div id="test-output" class="status info">
            Ready for testing...
        </div>
    </div>
    
    <div class="grid">
        <div class="test-section">
            <h2>7. Multiple Widget Instances</h2>
            <p>Testing multiple widgets on the same page:</p>
            
            <div class="demo-container">
                <div id="sso-widget-multi1" data-dc-sso data-compact="true">Loading...</div>
            </div>
            
            <div class="demo-container">
                <div id="sso-widget-multi2" data-dc-sso data-compact="false">Loading...</div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>8. Dark Theme Widget</h2>
            <p>Widget with dark theme:</p>
            
            <div class="demo-container" style="background: #2d3748;">
                <div id="sso-widget-dark" data-dc-sso data-theme="dark">Loading...</div>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>9. Integration Instructions</h2>
        <p>To use this SSO system on your site:</p>
        
        <ol>
            <li><strong>Add the widget container:</strong>
                <div class="code-block">
&lt;div id="dc-auth" data-dc-sso&gt;&lt;/div&gt;
                </div>
            </li>
            
            <li><strong>Load the widget script:</strong>
                <div class="code-block">
&lt;script src="https://signup.distributedcreatives.org/dc-sso-widget.js"&gt;&lt;/script&gt;
                </div>
            </li>
            
            <li><strong>Optional: Add custom callbacks:</strong>
                <div class="code-block">
&lt;script&gt;
initDCSSO('dc-auth', {
    onLogin: function(user) {
        // Handle login
        console.log('User logged in:', user);
    },
    onLogout: function() {
        // Handle logout
        console.log('User logged out');
    }
});
&lt;/script&gt;
                </div>
            </li>
        </ol>
    </div>
    
    <!-- Load the SSO widget -->
    <script src="./dc-sso-widget.js"></script>
    
    <script>
        // Initialize the JavaScript widget with custom callbacks
        initDCSSO('sso-widget-js', {
            showAvatar: true,
            showName: true,
            showCreatorBadge: true,
            compact: false,
            theme: 'default',
            onLogin: function(user) {
                console.log('User logged in:', user);
                updateUserInfo(user);
                showMemberContent();
                updateTestOutput('success', 'User logged in: ' + user.name);
            },
            onLogout: function() {
                console.log('User logged out');
                clearUserInfo();
                hideMemberContent();
                updateTestOutput('info', 'User logged out');
            }
        });
        
        // Helper functions
        function updateUserInfo(user) {
            document.getElementById('auth-status').textContent = 'Logged In';
            document.getElementById('user-name').textContent = user.name || 'N/A';
            document.getElementById('user-email').textContent = user.email || 'N/A';
            document.getElementById('user-creator-types').textContent = 
                user.creator_types?.join(', ') || 'None';
            document.getElementById('user-created').textContent = 
                new Date(user.created_at).toLocaleDateString() || 'N/A';
            document.getElementById('user-verified').textContent = 
                user.verified ? 'Yes' : 'No';
            document.getElementById('user-status').textContent = 
                user.member_status || 'unknown';
            document.getElementById('user-details').style.display = 'block';
        }
        
        function clearUserInfo() {
            document.getElementById('auth-status').textContent = 'Logged Out';
            document.getElementById('user-details').style.display = 'none';
        }
        
        function showMemberContent() {
            document.getElementById('member-content').style.display = 'block';
            document.getElementById('public-content').style.display = 'none';
        }
        
        function hideMemberContent() {
            document.getElementById('member-content').style.display = 'none';
            document.getElementById('public-content').style.display = 'block';
        }
        
        function updateTestOutput(type, message) {
            const output = document.getElementById('test-output');
            output.className = 'status ' + type;
            output.textContent = new Date().toLocaleTimeString() + ': ' + message;
        }
        
        // Test functions
        function testSessionCheck() {
            const stored = localStorage.getItem('dc_user_session');
            if (stored) {
                const session = JSON.parse(stored);
                updateTestOutput('success', 'Session found: ' + session.user.name);
            } else {
                updateTestOutput('info', 'No session found');
            }
        }
        
        function testRefresh() {
            location.reload();
        }
        
        function testLocalStorage() {
            const stored = localStorage.getItem('dc_user_session');
            if (stored) {
                const session = JSON.parse(stored);
                updateTestOutput('success', 'Local storage: ' + JSON.stringify(session, null, 2));
            } else {
                updateTestOutput('info', 'No session in local storage');
            }
        }
        
        function testClearSession() {
            localStorage.removeItem('dc_user_session');
            updateTestOutput('success', 'Session cleared - refresh to see changes');
        }
        
        // Check initial state
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const stored = localStorage.getItem('dc_user_session');
                if (stored) {
                    const session = JSON.parse(stored);
                    if (session.expires > Date.now()) {
                        updateUserInfo(session.user);
                        showMemberContent();
                    }
                }
            }, 1000);
        });
    </script>
</body>
</html>